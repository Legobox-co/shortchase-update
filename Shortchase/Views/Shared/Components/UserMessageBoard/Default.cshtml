@model MessagerModel
@if (Model != null)
{





    string UserProfilePicture = Url.Content("~/img/avatar.png");
    if (!string.IsNullOrWhiteSpace(Model.UserProfilePicture))
    {
        UserProfilePicture = ImageHelper.ConvertImageToBase64(Model.UserProfilePicture);
    }

    <div class="UserMessageBoardWrapper">
        <span class="p-3 bg-darker-grey border-radius-ultra-low UserMessageBoardNotificationWrapper shadow" id="UserMessageBoardNotificationWrapper">
            <img src="@Url.Content("~/img/conversations.png")" class="img-fluid" width="30px" />
            @{ 
                string displayUnreadNumber = "display: none;";
                if (Model.UnreadMessagesCount > 0)
                {
                    displayUnreadNumber = "";
                }
            }
            <span class="badge bg-danger text-white MontserratBold" id="UnreadMessagesCountBadge" style="@displayUnreadNumber">
                @Model.UnreadMessagesCount
            </span>
        </span>
        <div class="UserMessageBoardContentWrapper shadow" id="UserMessageBoardContentWrapper" style="display:none;">
            <div class="row">
                <div class="col-sm-12 col-md-12 col-lg-12 UserMessageBoardContentHeader clickable" id="UserMessageBoardContentHeader">
                    <div class="row">
                        <div class="col-sm-12 py-2">
                            <img src="@Url.Content("~/img/shortchase_logo.png")" class="img-fluid " width="130px" />
                        </div>
                    </div>
                </div>
                <div class="col-sm-12 col-md-12 col-lg-12 UserMessageBoardContentBody py-3">
                    <div class="row">
                        <div class="col-sm-12 col-md-12 col-lg-4">
                            <p class="MontserratBold text-smaller text-left">Hi @Model.UserFirstName</p>
                            <p class="text-smallest text-left m-0">
                                Welcome to Shortchase.<br />
                                Feel free to ask us anything or share your feedback.
                            </p>

                            <div class="row py-2">
                                <div class="col-sm-12 col-md-12 col-lg-6 text-center">

                                    <img src="@Model.AdminProfilePicture" class="img-fluid rounded-circle d-none d-sm-none d-md-block d-lg-block d-xl-block" width="80px" />
                                    <img src="@Model.AdminProfilePicture" class="img-fluid rounded-circle d-block d-sm-block d-md-none d-lg-none d-xl-none" width="40px" />
                                </div>
                                <div class="col-sm-12 col-md-12 col-lg-6">
                                    <p class="m-0 text-smaller h-100 d-flex flex-column justify-content-center align-items-start">
                                        <span class="MontserratBold">@Model.AdminName</span>
                                        <span class="text-smallest">
                                            @if (Model.IsAdminOnline)
                                            {
                                                <text><span class="text-success">Online</span></text>
                                            }
                                            else
                                            {
                                                <text>Away</text>
                                            }
                                        </span>
                                    </p>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-12 col-md-12 col-lg-8">
                            <div class="h-100 bg-white border-radius-ultra-low shadow-sm UserMessageBoardMessagesExchangedWrapper p-2 text-smallest" id="UserMessageBoardMessagesExchangedWrapper">
                                @if (Model.Messages.Count <= 0)
                                {
                                    <text>No messages yet.</text>
                                }
                                else
                                {
                                    foreach (var item in Model.Messages)
                                    {


                                        string senderProfilePicture = Url.Content("~/img/avatar.png");
                                        if (!string.IsNullOrWhiteSpace(item.From.ProfilePicture))
                                        {
                                            senderProfilePicture = ImageHelper.ConvertImageToBase64(item.From.ProfilePicture);
                                        }
                                        <div class="row pb-2">
                                            <div class="col-sm-12 col-md-12 col-lg-6 MontserratBold">
                                                <p class="m-0">
                                                    <img src="@senderProfilePicture" class="img-fluid rounded-circle" width="20px" />
                                                    <span>@item.From.FirstName @item.From.LastName</span>
                                                </p>
                                            </div>
                                            <div class="col-sm-12 col-md-12 col-lg-6 text-right text-muted">
                                                @DateHelper.DateSimpleFormat(item.RowDate)
                                            </div>
                                            <div class="col-sm-12 col-md-12 col-lg-12 py-1">
                                                @item.Content
                                            </div>
                                            <div class="col-sm-12 col-md-12 col-lg-12">
                                                <hr class="m-0" />
                                            </div>
                                        </div>
                                    }
                                }
                            </div>
                        </div>
                        <div class="col-sm-12 col-md-12 col-lg-12 pt-3 pb-2">
                            <form class="d-flex flex-row justify-content-center align-items-center" id="MessagerForm">
                                <div class="d-flex flex-80 h-100">
                                    <textarea class="form-control no-resize text-smaller" id="MessagerMessageToSend" placeholder="Type your message here..."></textarea>
                                </div>
                                <div class="d-flex flex-20 h-100">
                                    <button type="submit" class="btn btn-warning btn-orange text-white btn-block text-small h-100 py-2andHalf">Send</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <input type="hidden" id="SendMessageURL" value="@Url.Action("SendMessage", "Home")" />
}
