@model WebsiteUserConfirmSubscriptionPlanDto
@{
    Layout = "_WebsiteLayout";
}

<section class="bg-grey-dark-3">
    <div class="container">
        <div class="row">
            <div class="col-sm-12 col-md-12 col-lg-12">
                <h2 class="section-title pb-5 text-center">
                    Subscriptions
                </h2>
            </div>
        </div>
        <div class="card shadow">
            <div class="card-body px-2 py-3">
                @if (Model.CanSubscribe)
                {
                    <h4 class="mb-4">Confirm Subscription</h4>
                    <table class="table table-striped table-bordered w-100 text-smaller" cellspacing="0">
                        <thead>
                            <tr>
                                <th>Plan</th>
                                <th>Duration (Month)</th>
                                <th>Start Date</th>
                                <th>End Date</th>
                                <th>Total Price</th>
                            </tr>
                        </thead>
                        <tbody>

                            <tr>
                                <td>
                                    @if (Model.SubscriptionPlan.Type == SubscriptionPlanType.ShortchasePro)
                                    {
                                        <text>@Model.SubscriptionPlan.Name</text>
                                    }
                                    else
                                    {
                                        <text>@Model.SubscriptionPlan.Type @Model.SubscriptionPlan.Name</text>
                                    }
                                </td>
                                <td>
                                    @Model.SubscriptionPlan.DurationInMonths
                                </td>
                                <td>
                                    @DateHelper.DateSimpleFormat(Model.StartDate.FromUTCData(Convert.ToInt32(ViewData["TimezoneOffset"].ToString())))
                                </td>
                                <td>
                                    @DateHelper.DateSimpleFormat(Model.EndDate.FromUTCData(Convert.ToInt32(ViewData["TimezoneOffset"].ToString())))
                                </td>
                                <td class="MontserratBold">
                                    $ @Model.SubscriptionPlan.TotalValuePerDuration.ToString("0.00")
                                </td>
                            </tr>


                        </tbody>
                    </table>

                    <div class="row pb-3">
                        @{

                            decimal ValueToPay = Model.TaxValue + Model.FeeValue + Model.SubscriptionPlan.TotalValuePerDuration;
                        }
                        <input type="hidden" id="fundsNeededToCompleteOrder" value="@ValueToPay.ToString("0.00")" />
                        <div class="col-sm-12 col-md-12 col-lg-12 pt-4 pb-2">
                            <div class="form-check text-smaller mt-4 mt-sm-0 mt-md-0 mt-lg-0">
                                <input class="form-check-input my-0 mt-1" type="checkbox" value="" id="TermsAndConditionsAgreement">
                                <label class="form-check-label pl-2" for="TermsAndConditionsAgreement">
                                    I have read and agree to the <a asp-action="TermsAndConditions" asp-controller="Home" class="text-decoration-none text-dark MontserratBold" target="_blank">Terms & Conditions</a>
                                </label>
                            </div>
                            <div class="form-check text-smaller mt-4 mt-sm-0 mt-md-0 mt-lg-0">
                                <input class="form-check-input my-0 mt-1" type="checkbox" value="" id="PrivacyPolicyAgreement">
                                <label class="form-check-label pl-2" for="PrivacyPolicyAgreement">
                                    I have read and agree to the <a asp-action="PrivacyPolicy" asp-controller="Home" class="text-decoration-none text-dark MontserratBold" target="_blank">Privacy Policy</a>
                                </label>
                            </div>
                            <div class="form-check text-smaller mt-4 mt-sm-0 mt-md-0 mt-lg-0">
                                <input class="form-check-input my-0 mt-1" type="checkbox" value="" id="AutoRenewalAgreement">
                                <label class="form-check-label pl-2" for="AutoRenewalAgreement">
                                    I understand to ensure uninterrupted service and that my
                                    @if (Model.SubscriptionPlan.Type == SubscriptionPlanType.ShortchasePro)
                                    {
                                        <text>Shortchase Pro</text>
                                    }
                                    else
                                    {
                                        <text>Shortchase Boisterous</text>
                                    }
                                    account will renew
                                    @if (Model.SubscriptionPlan.Type == SubscriptionPlanType.ShortchasePro)
                                    {
                                        <text>Monthly</text>
                                    }
                                    else
                                    {
                                        <text>@Model.SubscriptionPlan.Name</text>
                                    }
                                    unless cancelled before the end of the term by emailing <a href="mailto:support@shortchase.com">support@shortchase.com</a>.
                                </label>
                            </div>

                        </div>
                        
                    </div>

                    <div class="row">
                        <div class="col-sm-12 col-md-12 col-lg-12 ">
                            <div class="h-100 d-flex justify-content-end align-items-center">
                                <a class="btn btn-default text-smaller timezoneoffset" asp-action="Subscription" asp-controller="Home" asp-route-Plan="@Model.SubscriptionPlan.Type">Back</a>
                                <span>&nbsp;&nbsp;&nbsp;</span>
                                @if (Model.HaveEnoughWalletFunds)
                                {
                                    <button class="btn btn-dark text-smaller timezoneoffset FinishSubscriptionWalletBtn">Finish</button>
                                }
                                else
                                {
                                    <button class="btn btn-dark text-smaller timezoneoffset FinishSubscriptionPaypalBtn" id="FinishSubscriptionPaypalBtn">Finish</button>
                                }
                            </div>

                        </div>

                        <div class="col-sm-12 col-md-12 col-lg-12 text-center" id="paypalButtonsWrapper" style="display:none;">

                            <div id="paypal-button-container"></div>
                        </div>
                    </div>
                }
                else
                {
                    <p class="m-0 text-center">
                        You already have a subscription on this as @Model.SubscriptionPlan.Type.
                        <br />
                        <a asp-action="Index" asp-controller="Home" class="btn btn-dark btn-sm text-smaller timezoneoffset">Back</a>
                    </p>
                }
            </div>
        </div>
    </div>
</section>

<input type="hidden" id="FinishSubscriptionWalletUrl" value="@Url.Action("FinishSubscriptionWallet", "Home")" />
<input type="hidden" id="FinishSubscriptionPaypal2Url" value="@Url.Action("FinishSubscriptionPaypal2", "Home")" />
<input type="hidden" id="RedirectUrl" value="@Url.Action("Index", "Home")" />
<input type="hidden" id="SubscriptionIdValue" value="@Model.SubscriptionPlan.Id" />
<input type="hidden" id="PaypalSubscriptionPlanIdValue" value="@Model.SubscriptionPlan.PaypalSubscriptionPlanId" />

@section Scripts{
    <vc:paypal-subscription-script></vc:paypal-subscription-script>
    <script src="@Url.Content("~/app/Home/SubscriptionConfirmation.js")" asp-append-version="true"></script>
}